<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Working with molecular graphs &mdash; MolMod 1.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="MolMod 1.1 documentation" href="../index.html" />
    <link rel="up" title="MolMod by example" href="examples.html" />
    <link rel="next" title="Internal coordinates" href="internal_coordinates.html" />
    <link rel="prev" title="Working with molecules" href="molecule.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="internal_coordinates.html" title="Internal coordinates"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="molecule.html" title="Working with molecules"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">MolMod 1.1 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="examples.html" accesskey="U">MolMod by example</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="working-with-molecular-graphs">
<h1>Working with molecular graphs<a class="headerlink" href="#working-with-molecular-graphs" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Molecular graphs are objects that describe the connectivity of atoms in a
molecule. In graph speech, every atom is a vertex and every bond is an edge.
Some background on <a class="reference external" href="http://en.wikipedia.org/wiki/Graph_theory">Graph Theory</a>
may be helpful. The <a class="reference internal" href="../reference/basic.html#molmod.molecular_graphs.MolecularGraph" title="molmod.molecular_graphs.MolecularGraph"><code class="xref py py-class docutils literal"><span class="pre">molmod.molecular_graphs.MolecularGraph</span></code></a> class in
MolMod can store atomic numbers associated with vertices and bond orders
associated with edges. The class <a class="reference internal" href="../reference/basic.html#molmod.graphs.Graph" title="molmod.graphs.Graph"><code class="xref py py-class docutils literal"><span class="pre">molmod.graphs.Graph</span></code></a> is the base class
that implements all the abstract graph theory without refering to atoms and
bonds.</p>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<div class="section" id="edges">
<h3>Edges<a class="headerlink" href="#edges" title="Permalink to this headline">¶</a></h3>
<p>The first example shows how one creates a molecular graph.. The most important
attribute of a graph object is <code class="docutils literal"><span class="pre">edges</span></code>. This is (in most cases) a list of
bonds in the molecule, but more edges may be included if that would be useful.</p>
<p>File: <code class="docutils literal"><span class="pre">data/examples/002_graphs/a_graphs.py</span></code></p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#!/usr/bin/env python</span>
<span class="c"># -*- coding: utf-8 -*-</span>
<span class="c"># MolMod is a collection of molecular modelling tools for python.</span>
<span class="c"># Copyright (C) 2007 - 2012 Toon Verstraelen &lt;Toon.Verstraelen@UGent.be&gt;, Center</span>
<span class="c"># for Molecular Modeling (CMM), Ghent University, Ghent, Belgium; all rights</span>
<span class="c"># reserved unless otherwise stated.</span>
<span class="c">#</span>
<span class="c"># This file is part of MolMod.</span>
<span class="c">#</span>
<span class="c"># MolMod is free software; you can redistribute it and/or</span>
<span class="c"># modify it under the terms of the GNU General Public License</span>
<span class="c"># as published by the Free Software Foundation; either version 3</span>
<span class="c"># of the License, or (at your option) any later version.</span>
<span class="c">#</span>
<span class="c"># MolMod is distributed in the hope that it will be useful,</span>
<span class="c"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c"># GNU General Public License for more details.</span>
<span class="c">#</span>
<span class="c"># You should have received a copy of the GNU General Public License</span>
<span class="c"># along with this program; if not, see &lt;http://www.gnu.org/licenses/&gt;</span>
<span class="c">#</span>
<span class="c">#--</span>
<span class="c">#!/usr/bin/env python</span>

<span class="kn">from</span> <span class="nn">molmod</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c"># 0) Create a molecule object based on the XYZ file &#39;caffeine.xyz&#39;.</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s">&quot;caffeine.xyz&quot;</span><span class="p">)</span>

<span class="c"># 1) Newly created molecule objects do not have a graph, unless bond information</span>
<span class="c"># is present in the data file. XYZ files only contain atomic elements and</span>
<span class="c"># the corresponding coordinates. Therefore, the following line will not raise</span>
<span class="c"># an error:</span>
<span class="k">assert</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">graph</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">)</span>

<span class="c"># 2) A molecular graph object can be derived from the geometry using a few rules</span>
<span class="c"># of thumb and a database of well-known bond lengths. Such a routine is</span>
<span class="c"># implemented in MolMod. It works as follows:</span>
<span class="n">mol</span><span class="o">.</span><span class="n">set_default_graph</span><span class="p">()</span>
<span class="c"># There are also other ways to define graphs with more control over the rules of</span>
<span class="c"># thumb that detect the bonded atom pairs, e.g.</span>
<span class="c">#</span>
<span class="c">#   mol.graph = MolecularGraph.from_geometry(scaling=1.5)</span>
<span class="c">#</span>
<span class="c"># will also detect the breaking bond in a transition state.</span>

<span class="c"># 3) Print all edges, i.e. bonds in the graph. The edges list is ordered and</span>
<span class="c"># each item is a frozenset with two elements to stress the undericted nature of</span>
<span class="c"># the molecular graphs.</span>
<span class="k">print</span> <span class="s">&quot;All edges (or bonds)&quot;</span>
<span class="k">print</span> <span class="n">mol</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">edges</span>
<span class="k">print</span>
<span class="c"># Print the third bond.</span>
<span class="k">print</span> <span class="s">&quot;The third bond:&quot;</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="c"># It is not possible to access only one of the two atom indexes of an edge. The</span>
<span class="c"># following won&#39;t work because a frozenset is like unordered list.</span>
<span class="c">#</span>
<span class="c">#   print graph.edges[2][0]</span>
<span class="c">#</span>
<span class="c"># One can get both indexes of an edge at the same time:</span>
<span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="k">print</span> <span class="s">&quot;The indexes of the second bond:&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s">&quot;and&quot;</span><span class="p">,</span> <span class="n">j</span>
<span class="c"># It is not possible to know a priori which number is assigned to i and which to</span>
<span class="c"># j.</span>

<span class="c"># 4) Print all the atom indexes of all C-H bonds on screen. Note that counting</span>
<span class="c"># starts from zero.</span>
<span class="c"># The loop relies on the &#39;unpack&#39; feature in Python. It is equivalent to</span>
<span class="c">#</span>
<span class="c">#   for edge in mol.graph.edges:</span>
<span class="c">#       i, j = edge</span>
<span class="c">#</span>
<span class="c"># but is a little more compact.</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">mol</span><span class="o">.</span><span class="n">numbers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">6</span> <span class="ow">and</span> <span class="n">mol</span><span class="o">.</span><span class="n">numbers</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&quot;C-H bond:&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span>
    <span class="k">elif</span> <span class="n">mol</span><span class="o">.</span><span class="n">numbers</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">6</span> <span class="ow">and</span> <span class="n">mol</span><span class="o">.</span><span class="n">numbers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&quot;C-H bond:&quot;</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">i</span>
</pre></div>
</div>
<p>From the edges many related properties can be derived. They are accessible
as attributes of a graph object and are only constructed the first time they
are used. A few examples, e.g. <code class="docutils literal"><span class="pre">neighbors</span></code>, <code class="docutils literal"><span class="pre">distances</span></code>, or <code class="docutils literal"><span class="pre">symmetries</span></code>.</p>
</div>
<div class="section" id="neighbors">
<h3>Neighbors<a class="headerlink" href="#neighbors" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">neighbors</span></code> attribute is a dictionary that relates each vertex, i.e atom,
in the graph with its direct neighbors. It can be used to get the direct
chemical environment of an atom, or just to count the number of bonds.</p>
<p>File: <code class="docutils literal"><span class="pre">data/examples/002_graphs/b_neighbors.py</span></code></p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#!/usr/bin/env python</span>
<span class="c"># -*- coding: utf-8 -*-</span>
<span class="c"># MolMod is a collection of molecular modelling tools for python.</span>
<span class="c"># Copyright (C) 2007 - 2012 Toon Verstraelen &lt;Toon.Verstraelen@UGent.be&gt;, Center</span>
<span class="c"># for Molecular Modeling (CMM), Ghent University, Ghent, Belgium; all rights</span>
<span class="c"># reserved unless otherwise stated.</span>
<span class="c">#</span>
<span class="c"># This file is part of MolMod.</span>
<span class="c">#</span>
<span class="c"># MolMod is free software; you can redistribute it and/or</span>
<span class="c"># modify it under the terms of the GNU General Public License</span>
<span class="c"># as published by the Free Software Foundation; either version 3</span>
<span class="c"># of the License, or (at your option) any later version.</span>
<span class="c">#</span>
<span class="c"># MolMod is distributed in the hope that it will be useful,</span>
<span class="c"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c"># GNU General Public License for more details.</span>
<span class="c">#</span>
<span class="c"># You should have received a copy of the GNU General Public License</span>
<span class="c"># along with this program; if not, see &lt;http://www.gnu.org/licenses/&gt;</span>
<span class="c">#</span>
<span class="c">#--</span>
<span class="c">#!/usr/bin/env python</span>

<span class="kn">from</span> <span class="nn">molmod</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c"># 0) Create a molecule object based on the XYZ file &#39;caffeine.xyz&#39;. Also</span>
<span class="c"># initialize the graph.</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s">&quot;caffeine.xyz&quot;</span><span class="p">)</span>
<span class="n">mol</span><span class="o">.</span><span class="n">set_default_graph</span><span class="p">()</span>
<span class="c"># The neighbors attribute is a dictionary with atom indexes as keys and a set</span>
<span class="c"># of neighboring atom indexes as corresponding values. The dictionary will be</span>
<span class="c"># constructed as soon as it is first accessed, e.g.</span>
<span class="k">print</span> <span class="s">&quot;All neighbors:&quot;</span>
<span class="k">print</span> <span class="n">mol</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">neighbors</span>
<span class="k">print</span>

<span class="c"># 1) Print the atomic number of the third atom and the atomic numbers of its</span>
<span class="c"># neighbors.</span>
<span class="k">print</span> <span class="s">&quot;Symbol of third atom (should be oxygen):&quot;</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="k">print</span> <span class="s">&quot;The number of bonds to the third atom:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">neighbors</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="k">print</span> <span class="s">&quot;Indexes of neigbors of third atom:&quot;</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">neighbors</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="k">print</span> <span class="s">&quot;Symbols of neigbors of third atom:&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">mol</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">neighbors</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>

<span class="c"># 2) Look up all methyl groups.</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ns</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">neighbors</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">mol</span><span class="o">.</span><span class="n">numbers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">6</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
        <span class="c"># Get the indexes of the hydrogen atoms.</span>
        <span class="n">h_indexes</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">ns</span> <span class="k">if</span> <span class="n">mol</span><span class="o">.</span><span class="n">numbers</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span>
        <span class="c"># We must have three hydrogens</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">h_indexes</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c"># Print stuff</span>
        <span class="k">print</span> <span class="s">&quot;C=</span><span class="si">%i</span><span class="s"> H=</span><span class="si">%i</span><span class="s"> H=</span><span class="si">%i</span><span class="s"> H=</span><span class="si">%i</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">h_indexes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">h_indexes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">h_indexes</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="distances">
<h3>Distances<a class="headerlink" href="#distances" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">distances</span></code> attribute is a square matrix with a row and a column for every
vertex. Each element contains the (minimal) number of bonds between two atoms.
The matrix is constructed with the <a class="reference external" href="http://en.wikipedia.org/wiki/Floyd%E2%80%93Warshall_algorithm">Floyd-Warshall algorithm</a>.</p>
<p>File: <code class="docutils literal"><span class="pre">data/examples/002_graphs/c_distances.py</span></code></p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#!/usr/bin/env python</span>
<span class="c"># -*- coding: utf-8 -*-</span>
<span class="c"># MolMod is a collection of molecular modelling tools for python.</span>
<span class="c"># Copyright (C) 2007 - 2012 Toon Verstraelen &lt;Toon.Verstraelen@UGent.be&gt;, Center</span>
<span class="c"># for Molecular Modeling (CMM), Ghent University, Ghent, Belgium; all rights</span>
<span class="c"># reserved unless otherwise stated.</span>
<span class="c">#</span>
<span class="c"># This file is part of MolMod.</span>
<span class="c">#</span>
<span class="c"># MolMod is free software; you can redistribute it and/or</span>
<span class="c"># modify it under the terms of the GNU General Public License</span>
<span class="c"># as published by the Free Software Foundation; either version 3</span>
<span class="c"># of the License, or (at your option) any later version.</span>
<span class="c">#</span>
<span class="c"># MolMod is distributed in the hope that it will be useful,</span>
<span class="c"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c"># GNU General Public License for more details.</span>
<span class="c">#</span>
<span class="c"># You should have received a copy of the GNU General Public License</span>
<span class="c"># along with this program; if not, see &lt;http://www.gnu.org/licenses/&gt;</span>
<span class="c">#</span>
<span class="c">#--</span>
<span class="c">#!/usr/bin/env python</span>

<span class="kn">from</span> <span class="nn">molmod</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c"># 0) Create a molecule object based on the XYZ file &#39;caffeine.xyz&#39;. Also</span>
<span class="c"># initialize the graph.</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s">&quot;caffeine.xyz&quot;</span><span class="p">)</span>
<span class="n">mol</span><span class="o">.</span><span class="n">set_default_graph</span><span class="p">()</span>
<span class="c"># The distances attribute is a square matrix of integers with a row and column</span>
<span class="c"># for every atom.</span>
<span class="k">print</span> <span class="s">&quot;Number of atoms:&quot;</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">size</span>
<span class="k">print</span> <span class="s">&quot;Shape of the distances array:&quot;</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">distances</span><span class="o">.</span><span class="n">shape</span>

<span class="c"># 1) The distances array can be used to get the &#39;minimal&#39; number of bonds</span>
<span class="c"># between two atoms. E.g. for two atoms in a five_membered ring, this is at most</span>
<span class="c"># two:</span>
<span class="k">print</span> <span class="s">&quot;Distance between atom 5 and 6 (part of a 5-ring):&quot;</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">distances</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>

<span class="c"># 2) The matrix can also be used to construct a mask of atom_pairs that are</span>
<span class="c"># separated by at most three bonds.</span>
<span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">distances</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">distances</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
<span class="c"># For a nice print output, the mask is converted to integers.</span>
<span class="k">print</span> <span class="s">&quot;Mask of atom pairs that are typically involved in valence interactions:&quot;</span>
<span class="k">print</span> <span class="n">mask</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="symmetries">
<h3>Symmetries<a class="headerlink" href="#symmetries" title="Permalink to this headline">¶</a></h3>
<p>All isomorphisms of a molecular graph can be requested. For molecular graphs,
only those isomorphisms are considered that do not alter the atomic numbers.</p>
<p>File: <code class="docutils literal"><span class="pre">data/examples/002_graphs/d_symmetries.py</span></code></p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#!/usr/bin/env python</span>
<span class="c"># -*- coding: utf-8 -*-</span>
<span class="c"># MolMod is a collection of molecular modelling tools for python.</span>
<span class="c"># Copyright (C) 2007 - 2012 Toon Verstraelen &lt;Toon.Verstraelen@UGent.be&gt;, Center</span>
<span class="c"># for Molecular Modeling (CMM), Ghent University, Ghent, Belgium; all rights</span>
<span class="c"># reserved unless otherwise stated.</span>
<span class="c">#</span>
<span class="c"># This file is part of MolMod.</span>
<span class="c">#</span>
<span class="c"># MolMod is free software; you can redistribute it and/or</span>
<span class="c"># modify it under the terms of the GNU General Public License</span>
<span class="c"># as published by the Free Software Foundation; either version 3</span>
<span class="c"># of the License, or (at your option) any later version.</span>
<span class="c">#</span>
<span class="c"># MolMod is distributed in the hope that it will be useful,</span>
<span class="c"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c"># GNU General Public License for more details.</span>
<span class="c">#</span>
<span class="c"># You should have received a copy of the GNU General Public License</span>
<span class="c"># along with this program; if not, see &lt;http://www.gnu.org/licenses/&gt;</span>
<span class="c">#</span>
<span class="c">#--</span>
<span class="c">#!/usr/bin/env python</span>

<span class="kn">from</span> <span class="nn">molmod</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c"># 0) Create a molecule object based on the XYZ file &#39;ethanol.xyz&#39;. Also</span>
<span class="c"># initialize the graph.</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s">&quot;ethanol.xyz&quot;</span><span class="p">)</span>
<span class="n">mol</span><span class="o">.</span><span class="n">set_default_graph</span><span class="p">()</span>

<span class="c"># 1) Print out all the isomorphisms. For the ethanol molecule, this comes down</span>
<span class="c"># to all possible ways to rotate/mirror the methyl moieties, and combination</span>
<span class="c"># thereof.</span>
<span class="k">print</span> <span class="s">&quot;Isomorphisms in the form of one-to-one mappings&quot;</span>
<span class="k">for</span> <span class="n">symmetry</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">symmetries</span><span class="p">:</span>
    <span class="k">print</span> <span class="n">symmetry</span>

<span class="c"># 2) One can also request isomorphisms in the form of permutations, which is</span>
<span class="c"># often more convenient:</span>
<span class="k">print</span> <span class="s">&quot;Isomorphisms in the form of permutations&quot;</span>
<span class="k">for</span> <span class="n">cycle</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">symmetry_cycles</span><span class="p">:</span>
    <span class="k">print</span> <span class="n">cycle</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="problems">
<h2>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Write a program that prints the atom indexes of all the C-O bonds in the
caffeine molecule.</li>
<li>Write a program that prints the atom indexes of all the Nitrogen atoms that
are not bonded to a methyl group.</li>
<li>Write a program that finds all Nitrogen atoms in the caffeine that are at
least three bonds away from an Oxygen atom.</li>
<li>Download the <a class="reference external" href="http://pubchem.ncbi.nlm.nih.gov/summary/summary.cgi?cid=241&amp;disopt=3DSaveSDF">benzene</a>
molecule from Pubchem and write a program that prints out all the graph
isomorphisms as permutations. The SDF files from pubchem already contain the
bond graph, so there is no need for <code class="docutils literal"><span class="pre">mol.set_default_graph()</span></code> after loading
the molecule. How is the number of isomorphisms related to the rotational
symmetry number of benzene?</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Working with molecular graphs</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#examples">Examples</a><ul>
<li><a class="reference internal" href="#edges">Edges</a></li>
<li><a class="reference internal" href="#neighbors">Neighbors</a></li>
<li><a class="reference internal" href="#distances">Distances</a></li>
<li><a class="reference internal" href="#symmetries">Symmetries</a></li>
</ul>
</li>
<li><a class="reference internal" href="#problems">Problems</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="molecule.html"
                        title="previous chapter">Working with molecules</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="internal_coordinates.html"
                        title="next chapter">Internal coordinates</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/tutorial/graph.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="internal_coordinates.html" title="Internal coordinates"
             >next</a> |</li>
        <li class="right" >
          <a href="molecule.html" title="Working with molecules"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">MolMod 1.1 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="examples.html" >MolMod by example</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2010, Toon Verstraelen.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>