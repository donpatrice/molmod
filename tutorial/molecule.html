<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Working with molecules &mdash; MolMod 1.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="MolMod 1.1 documentation" href="../index.html" />
    <link rel="up" title="MolMod by example" href="examples.html" />
    <link rel="next" title="Working with molecular graphs" href="graph.html" />
    <link rel="prev" title="Unit conversion" href="units.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="graph.html" title="Working with molecular graphs"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="units.html" title="Unit conversion"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">MolMod 1.1 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="examples.html" accesskey="U">MolMod by example</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="working-with-molecules">
<h1>Working with molecules<a class="headerlink" href="#working-with-molecules" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<div class="section" id="molecule-objects">
<h3>Molecule objects<a class="headerlink" href="#molecule-objects" title="Permalink to this headline">¶</a></h3>
<p>The class <a class="reference internal" href="../reference/basic.html#molmod.molecules.Molecule" title="molmod.molecules.Molecule"><code class="xref py py-class docutils literal"><span class="pre">molmod.molecules.Molecule</span></code></a> is a fundamental part of the MolMod
package. Instances of this class hold all information to describe the geometry
and the topology of a molecular structure. In practice the following attributes
can be stored in a Molecule object:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">numbers</span></code>  &#8211;  An array of atomic numbers with N elements. This
is the only mandatory attribute. All other attributes are optional.</li>
<li><code class="docutils literal"><span class="pre">coordinates</span></code>  &#8211;  An array with atomic coordinates (in Bohr) with
shape (N,3).</li>
<li><code class="docutils literal"><span class="pre">title</span></code>  &#8211;  A short description of the molecule.</li>
<li><code class="docutils literal"><span class="pre">masses</span></code>  &#8211;  An array with atomic masses (in <img class="math" src="../_images/math/ef971078aeef8886f04df6b7210035b7e3bf1525.png" alt="m_e"/>)</li>
<li><code class="docutils literal"><span class="pre">graph</span></code>  &#8211;  A <code class="docutils literal"><span class="pre">MolecularGraph</span></code> instance describing the connectivity of
the atoms.</li>
<li><code class="docutils literal"><span class="pre">symbols</span></code>  &#8211;  A tuple with atomic symbols. These may be the names of the
elements or some force-field atom types.</li>
<li><code class="docutils literal"><span class="pre">unit_cell</span></code>  &#8211;  A <code class="docutils literal"><span class="pre">UnitCell</span></code> instance describing the periodic boundary
conditions.</li>
</ul>
<p>One can create Molecule instances based on several conventional file formats as
follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s">&quot;foo.xyz&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The extension of the file is used to detect the file format. The following
formats are currently supported: <code class="docutils literal"><span class="pre">*.cml</span></code>, <code class="docutils literal"><span class="pre">*.fchk</span></code>, <code class="docutils literal"><span class="pre">*.pdb</span></code>, <code class="docutils literal"><span class="pre">*.sdf</span></code>,
<code class="docutils literal"><span class="pre">*.xyz</span></code>. It is relatively trivial to implement new file formats, but there is
no real urgent need for that because the babel program can convert most files
into one of these formats.</p>
<p>A Molecule object can be written to file as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">mol</span><span class="o">.</span><span class="n">write_to_file</span><span class="p">(</span><span class="s">&quot;bar.xyz&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The currently supported formats for writing files are: <code class="docutils literal"><span class="pre">*.xyz</span></code>, <code class="docutils literal"><span class="pre">*.cml</span></code></p>
</div>
<div class="section" id="derived-quantities">
<h3>Derived quantities<a class="headerlink" href="#derived-quantities" title="Permalink to this headline">¶</a></h3>
<p>Some derived quantities are accessible as attributes. The contents of these
attributes are only computed when they are accessed for the first time. Once a
derived quantity is computed it is stored internally (in the molecule object) in
case it would be requested a second time. This mechanism is called <cite>caching</cite>. It
imposes good scripting practices when using the MolMod package and also improves
the efficiency of the scripts. These are a few convenient derived quantities:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">chemical_formula</span></code>  &#8211;  A string containing the chemical formula.</li>
<li><code class="docutils literal"><span class="pre">com</span></code>  &#8211;  The center of mass of the molecule.</li>
<li><code class="docutils literal"><span class="pre">distance_matrix</span></code>  &#8211;  A square matrix with all inter-atomic distances in
a molecule (ignoring periodic boundary conditions for the moment).</li>
<li><code class="docutils literal"><span class="pre">inertia_tensor</span></code>  &#8211;  The inertia tensor of the molecule computed with the
center of mass as the origin.</li>
<li><code class="docutils literal"><span class="pre">mass</span></code>  &#8211;  The total mass of the system.</li>
<li><code class="docutils literal"><span class="pre">size</span></code>  &#8211;  The number of atoms.</li>
</ul>
<p>An up-to-date list can be found in the reference documentation:
<a class="reference internal" href="../reference/basic.html#molmod.molecules.Molecule" title="molmod.molecules.Molecule"><code class="xref py py-class docutils literal"><span class="pre">molmod.molecules.Molecule</span></code></a>. Most derived quantities depend on optional
attributes. If these optional attributes are not present, an error is raised
when a derived quantity is requested.</p>
</div>
<div class="section" id="modifying-molecule-objects">
<h3>Modifying molecule objects<a class="headerlink" href="#modifying-molecule-objects" title="Permalink to this headline">¶</a></h3>
<p>The <cite>caching</cite> mechanism has one important side-effect. When the underlying data
of the derived quantities change, the <cite>cached</cite> results are no longer correct.
This problem is called <cite>cache inconsistency</cite>. There are typically two ways to
impose <cite>cache consistency</cite>: (i) all underlying quantities are kept constant, or
(ii) cached results are deleted when the underlying data change. The first
mechanism is used throughout the MolMod package. When you need to modify a
<code class="docutils literal"><span class="pre">Molecule</span></code> object, just create a new one with modified attributes. This is
facilitated by the <code class="docutils literal"><span class="pre">copy_with</span></code> method:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">mol1</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s">&quot;foo.xyz&quot;</span><span class="p">)</span>
<span class="n">mol2</span> <span class="o">=</span> <span class="n">mol1</span><span class="o">.</span><span class="n">copy_with</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&quot;bar&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Any of the above attributes can be modified through <code class="docutils literal"><span class="pre">copy_with</span></code>. Cached
derived quantities are never discarded with this approach.</p>
<p>The concept of derived quantities and read-only attributes is extensively used
in the following classes:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">Molecule</span></code>, see <a class="reference internal" href="../reference/basic.html#molmod.molecules.Molecule" title="molmod.molecules.Molecule"><code class="xref py py-class docutils literal"><span class="pre">molmod.molecules.Molecule</span></code></a>.</li>
<li><code class="docutils literal"><span class="pre">Graph</span></code>, see <a class="reference internal" href="../reference/basic.html#molmod.graphs.Graph" title="molmod.graphs.Graph"><code class="xref py py-class docutils literal"><span class="pre">molmod.graphs.Graph</span></code></a>.</li>
<li><code class="docutils literal"><span class="pre">MolecularGraph</span></code>, see <a class="reference internal" href="../reference/basic.html#molmod.molecular_graphs.MolecularGraph" title="molmod.molecular_graphs.MolecularGraph"><code class="xref py py-class docutils literal"><span class="pre">molmod.molecular_graphs.MolecularGraph</span></code></a>.</li>
<li><code class="docutils literal"><span class="pre">UnitCell</span></code>, see <a class="reference internal" href="../reference/basic.html#molmod.unit_cells.UnitCell" title="molmod.unit_cells.UnitCell"><code class="xref py py-class docutils literal"><span class="pre">molmod.unit_cells.UnitCell</span></code></a>.</li>
<li><code class="docutils literal"><span class="pre">Translation</span></code>, see <a class="reference internal" href="../reference/basic.html#molmod.transformations.Translation" title="molmod.transformations.Translation"><code class="xref py py-class docutils literal"><span class="pre">molmod.transformations.Translation</span></code></a>.</li>
<li><code class="docutils literal"><span class="pre">Rotation</span></code>, see <a class="reference internal" href="../reference/basic.html#molmod.transformations.Rotation" title="molmod.transformations.Rotation"><code class="xref py py-class docutils literal"><span class="pre">molmod.transformations.Rotation</span></code></a>.</li>
<li><code class="docutils literal"><span class="pre">Complete</span></code>, see <a class="reference internal" href="../reference/basic.html#molmod.transformations.Complete" title="molmod.transformations.Complete"><code class="xref py py-class docutils literal"><span class="pre">molmod.transformations.Complete</span></code></a>.</li>
</ul>
</div>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<div class="section" id="conversion-of-files">
<h3>Conversion of files<a class="headerlink" href="#conversion-of-files" title="Permalink to this headline">¶</a></h3>
<p>Although the conversion of files with molecular systems from one format to the
other is easily done with the babel program, the example is still useful for
didactic purposes.</p>
<p>File: <code class="docutils literal"><span class="pre">data/examples/001_molecules/a_convert.py</span></code></p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#!/usr/bin/env python</span>
<span class="c"># -*- coding: utf-8 -*-</span>
<span class="c"># MolMod is a collection of molecular modelling tools for python.</span>
<span class="c"># Copyright (C) 2007 - 2012 Toon Verstraelen &lt;Toon.Verstraelen@UGent.be&gt;, Center</span>
<span class="c"># for Molecular Modeling (CMM), Ghent University, Ghent, Belgium; all rights</span>
<span class="c"># reserved unless otherwise stated.</span>
<span class="c">#</span>
<span class="c"># This file is part of MolMod.</span>
<span class="c">#</span>
<span class="c"># MolMod is free software; you can redistribute it and/or</span>
<span class="c"># modify it under the terms of the GNU General Public License</span>
<span class="c"># as published by the Free Software Foundation; either version 3</span>
<span class="c"># of the License, or (at your option) any later version.</span>
<span class="c">#</span>
<span class="c"># MolMod is distributed in the hope that it will be useful,</span>
<span class="c"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c"># GNU General Public License for more details.</span>
<span class="c">#</span>
<span class="c"># You should have received a copy of the GNU General Public License</span>
<span class="c"># along with this program; if not, see &lt;http://www.gnu.org/licenses/&gt;</span>
<span class="c">#</span>
<span class="c">#--</span>
<span class="c">#!/usr/bin/env python</span>

<span class="kn">from</span> <span class="nn">molmod</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s">&quot;ibuprofen.sdf&quot;</span><span class="p">)</span>
<span class="n">mol</span><span class="o">.</span><span class="n">write_to_file</span><span class="p">(</span><span class="s">&quot;ibuprofen.xyz&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="center-of-mass-to-origin">
<h3>Center of mass to origin<a class="headerlink" href="#center-of-mass-to-origin" title="Permalink to this headline">¶</a></h3>
<p>This example shows how a modified molecule object is made.</p>
<p>File: <code class="docutils literal"><span class="pre">data/examples/001_molecules/b_com.py</span></code></p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#!/usr/bin/env python</span>
<span class="c"># -*- coding: utf-8 -*-</span>
<span class="c"># MolMod is a collection of molecular modelling tools for python.</span>
<span class="c"># Copyright (C) 2007 - 2012 Toon Verstraelen &lt;Toon.Verstraelen@UGent.be&gt;, Center</span>
<span class="c"># for Molecular Modeling (CMM), Ghent University, Ghent, Belgium; all rights</span>
<span class="c"># reserved unless otherwise stated.</span>
<span class="c">#</span>
<span class="c"># This file is part of MolMod.</span>
<span class="c">#</span>
<span class="c"># MolMod is free software; you can redistribute it and/or</span>
<span class="c"># modify it under the terms of the GNU General Public License</span>
<span class="c"># as published by the Free Software Foundation; either version 3</span>
<span class="c"># of the License, or (at your option) any later version.</span>
<span class="c">#</span>
<span class="c"># MolMod is distributed in the hope that it will be useful,</span>
<span class="c"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c"># GNU General Public License for more details.</span>
<span class="c">#</span>
<span class="c"># You should have received a copy of the GNU General Public License</span>
<span class="c"># along with this program; if not, see &lt;http://www.gnu.org/licenses/&gt;</span>
<span class="c">#</span>
<span class="c">#--</span>
<span class="c">#!/usr/bin/env python</span>

<span class="kn">from</span> <span class="nn">molmod</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c"># 0) Load the molecule from file</span>
<span class="n">mol1</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s">&quot;ibuprofen.sdf&quot;</span><span class="p">)</span>

<span class="c"># 1) The atomic masses are not included in the sdf file. We need them below to</span>
<span class="c"># compute the center of mass, so we assign standard masses.</span>
<span class="n">mol1</span><span class="o">.</span><span class="n">set_default_masses</span><span class="p">()</span>
<span class="k">print</span> <span class="n">mol1</span><span class="o">.</span><span class="n">masses</span><span class="o">/</span><span class="n">amu</span>

<span class="c"># 2) Create modified coordinates. The attribute coordinates is an N by 3 array,</span>
<span class="c"># while the com attribute is an array with three components. The following</span>
<span class="c"># subtraction is performed elementwise at the level of the rows. Each row</span>
<span class="c"># of the coordinates array corresponds to one atom. From each atomic coordinate</span>
<span class="c"># the center of mass is subtracted to construct a new coordinates array.</span>
<span class="n">new_coordinates</span> <span class="o">=</span> <span class="n">mol1</span><span class="o">.</span><span class="n">coordinates</span> <span class="o">-</span> <span class="n">mol1</span><span class="o">.</span><span class="n">com</span>

<span class="c"># 3) Make a copy of mol1 with updated coordinates and write it to a file.</span>
<span class="n">mol2</span> <span class="o">=</span> <span class="n">mol1</span><span class="o">.</span><span class="n">copy_with</span><span class="p">(</span><span class="n">coordinates</span><span class="o">=</span><span class="n">new_coordinates</span><span class="p">)</span>
<span class="n">mol2</span><span class="o">.</span><span class="n">write_to_file</span><span class="p">(</span><span class="s">&quot;ibuprofen_com.xyz&quot;</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&quot;Written file ibuprofen_com.xyz&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="all-carbons">
<h3>All carbons<a class="headerlink" href="#all-carbons" title="Permalink to this headline">¶</a></h3>
<p>The following program prints the X-, Y- and Z-coordinates of all Carbon atoms in
the ibuprofen molecule.</p>
<p>File: <code class="docutils literal"><span class="pre">data/examples/001_molecules/c_carbon.py</span></code></p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#!/usr/bin/env python</span>
<span class="c"># -*- coding: utf-8 -*-</span>
<span class="c"># MolMod is a collection of molecular modelling tools for python.</span>
<span class="c"># Copyright (C) 2007 - 2012 Toon Verstraelen &lt;Toon.Verstraelen@UGent.be&gt;, Center</span>
<span class="c"># for Molecular Modeling (CMM), Ghent University, Ghent, Belgium; all rights</span>
<span class="c"># reserved unless otherwise stated.</span>
<span class="c">#</span>
<span class="c"># This file is part of MolMod.</span>
<span class="c">#</span>
<span class="c"># MolMod is free software; you can redistribute it and/or</span>
<span class="c"># modify it under the terms of the GNU General Public License</span>
<span class="c"># as published by the Free Software Foundation; either version 3</span>
<span class="c"># of the License, or (at your option) any later version.</span>
<span class="c">#</span>
<span class="c"># MolMod is distributed in the hope that it will be useful,</span>
<span class="c"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c"># GNU General Public License for more details.</span>
<span class="c">#</span>
<span class="c"># You should have received a copy of the GNU General Public License</span>
<span class="c"># along with this program; if not, see &lt;http://www.gnu.org/licenses/&gt;</span>
<span class="c">#</span>
<span class="c">#--</span>
<span class="c">#!/usr/bin/env python</span>

<span class="kn">from</span> <span class="nn">molmod</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c"># 0) Load the molecule</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s">&quot;ibuprofen.sdf&quot;</span><span class="p">)</span>

<span class="c"># 1) Print out all carbon positions</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">mol</span><span class="o">.</span><span class="n">numbers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">mol</span><span class="o">.</span><span class="n">coordinates</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">angstrom</span>
</pre></div>
</div>
</div>
<div class="section" id="size-of-a-molecule">
<h3>Size of a molecule<a class="headerlink" href="#size-of-a-molecule" title="Permalink to this headline">¶</a></h3>
<p>One can define the size of a molecule in several ways. The following program
prints out the largest inter-atomic distance in Ångström.</p>
<p>File: <code class="docutils literal"><span class="pre">data/examples/001_molecules/d_size.py</span></code></p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#!/usr/bin/env python</span>
<span class="c"># -*- coding: utf-8 -*-</span>
<span class="c"># MolMod is a collection of molecular modelling tools for python.</span>
<span class="c"># Copyright (C) 2007 - 2012 Toon Verstraelen &lt;Toon.Verstraelen@UGent.be&gt;, Center</span>
<span class="c"># for Molecular Modeling (CMM), Ghent University, Ghent, Belgium; all rights</span>
<span class="c"># reserved unless otherwise stated.</span>
<span class="c">#</span>
<span class="c"># This file is part of MolMod.</span>
<span class="c">#</span>
<span class="c"># MolMod is free software; you can redistribute it and/or</span>
<span class="c"># modify it under the terms of the GNU General Public License</span>
<span class="c"># as published by the Free Software Foundation; either version 3</span>
<span class="c"># of the License, or (at your option) any later version.</span>
<span class="c">#</span>
<span class="c"># MolMod is distributed in the hope that it will be useful,</span>
<span class="c"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c"># GNU General Public License for more details.</span>
<span class="c">#</span>
<span class="c"># You should have received a copy of the GNU General Public License</span>
<span class="c"># along with this program; if not, see &lt;http://www.gnu.org/licenses/&gt;</span>
<span class="c">#</span>
<span class="c">#--</span>
<span class="c">#!/usr/bin/env python</span>

<span class="kn">from</span> <span class="nn">molmod</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c"># 0) Load the molecule.</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s">&quot;ibuprofen.sdf&quot;</span><span class="p">)</span>

<span class="c"># 1) Print the largest element in the distance matrix.</span>
<span class="k">print</span> <span class="s">&quot;Largest interatomic distance [A]:&quot;</span>
<span class="k">print</span> <span class="n">mol</span><span class="o">.</span><span class="n">distance_matrix</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">/</span><span class="n">angstrom</span>
<span class="c"># Some comments:</span>
<span class="c">#  - One can just write code that assumes the attribute distance_matrix is</span>
<span class="c">#    present, but in fact it is only computed once the first time it is used.</span>
<span class="c">#  - The method max is a method of the numpy array. It returns the largest value</span>
<span class="c">#    in an array.</span>
</pre></div>
</div>
</div>
<div class="section" id="shape-of-a-molecule">
<h3>Shape of a molecule<a class="headerlink" href="#shape-of-a-molecule" title="Permalink to this headline">¶</a></h3>
<p>One can define the shape of a molecule based on the covariance of the atomic
coordinates with respect to their geometric center. Some shape categories were
introduced by <a class="reference external" href="http://en.wikipedia.org/wiki/Equidimensional">Zingg</a>. The
following program computes the shape category for the ibuprofen molecule</p>
<p>File: <code class="docutils literal"><span class="pre">data/examples/001_molecules/e_shape.py</span></code></p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#!/usr/bin/env python</span>
<span class="c"># -*- coding: utf-8 -*-</span>
<span class="c"># MolMod is a collection of molecular modelling tools for python.</span>
<span class="c"># Copyright (C) 2007 - 2012 Toon Verstraelen &lt;Toon.Verstraelen@UGent.be&gt;, Center</span>
<span class="c"># for Molecular Modeling (CMM), Ghent University, Ghent, Belgium; all rights</span>
<span class="c"># reserved unless otherwise stated.</span>
<span class="c">#</span>
<span class="c"># This file is part of MolMod.</span>
<span class="c">#</span>
<span class="c"># MolMod is free software; you can redistribute it and/or</span>
<span class="c"># modify it under the terms of the GNU General Public License</span>
<span class="c"># as published by the Free Software Foundation; either version 3</span>
<span class="c"># of the License, or (at your option) any later version.</span>
<span class="c">#</span>
<span class="c"># MolMod is distributed in the hope that it will be useful,</span>
<span class="c"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c"># GNU General Public License for more details.</span>
<span class="c">#</span>
<span class="c"># You should have received a copy of the GNU General Public License</span>
<span class="c"># along with this program; if not, see &lt;http://www.gnu.org/licenses/&gt;</span>
<span class="c">#</span>
<span class="c">#--</span>
<span class="c">#!/usr/bin/env python</span>

<span class="kn">from</span> <span class="nn">molmod</span> <span class="kn">import</span> <span class="o">*</span>

<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">dot</span><span class="p">,</span> <span class="n">sqrt</span>
<span class="kn">from</span> <span class="nn">numpy.linalg</span> <span class="kn">import</span> <span class="n">eigvalsh</span>


<span class="c"># 0) Load the molecule.</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s">&quot;ibuprofen.sdf&quot;</span><span class="p">)</span>

<span class="c"># 1) Compute the arithmetic center of the atomic coordinates.</span>
<span class="n">center</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">coordinates</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="c"># Without the axis=0 argument, the average over all X, Y and Z components would</span>
<span class="c"># be computed. Now it just computes the averages for each column. axis=1 would</span>
<span class="c"># refer to averaging over rows.</span>

<span class="c"># 2) Move the arithmetic center of the coordinates to the origin. The same</span>
<span class="c"># comments from the b_com.py apply.</span>
<span class="n">centered</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">coordinates</span> <span class="o">-</span> <span class="n">mol</span><span class="o">.</span><span class="n">coordinates</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c"># 3) Compute the covariance matrix of the centered coordinates.</span>
<span class="n">covar</span> <span class="o">=</span> <span class="n">dot</span><span class="p">(</span><span class="n">centered</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span> <span class="n">centered</span><span class="p">)</span><span class="o">/</span><span class="n">mol</span><span class="o">.</span><span class="n">size</span>

<span class="c"># 4) Compute the eigenvalues of the symmetric covariance matrix.</span>
<span class="n">evals</span> <span class="o">=</span> <span class="n">eigvalsh</span><span class="p">(</span><span class="n">covar</span><span class="p">)</span>

<span class="c"># 5) The spread along the three eigenvectors is computed as the standard deviation</span>
<span class="c"># of the atomic coordinates along that direction:</span>
<span class="n">c</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">evals</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&quot;Spread along the long axis [A]:&quot;</span><span class="p">,</span> <span class="n">a</span><span class="o">/</span><span class="n">angstrom</span>
<span class="k">print</span> <span class="s">&quot;Spread along the intermediate axis [A]:&quot;</span><span class="p">,</span> <span class="n">b</span><span class="o">/</span><span class="n">angstrom</span>
<span class="k">print</span> <span class="s">&quot;Spread along the short axis [A]:&quot;</span><span class="p">,</span> <span class="n">c</span><span class="o">/</span><span class="n">angstrom</span>

<span class="c"># 6) Test in which category this shape belongs. The factor R is set to 1.5.</span>
<span class="n">R</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="k">if</span> <span class="n">b</span> <span class="o">&lt;</span> <span class="n">R</span><span class="o">*</span><span class="n">c</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="n">R</span><span class="o">*</span><span class="n">b</span><span class="p">:</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="s">&#39;equant&#39;</span> <span class="c"># sphere-like</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="s">&#39;prolate&#39;</span> <span class="c"># sigar-like</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="n">R</span><span class="o">*</span><span class="n">b</span><span class="p">:</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="s">&#39;oblate&#39;</span> <span class="c"># pancake-like</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="s">&#39;bladed&#39;</span> <span class="c"># keyboard-like</span>
<span class="k">print</span> <span class="s">&quot;The shape category:&quot;</span><span class="p">,</span> <span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="problems">
<h2>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">Write a program that makes a list of all (unique) pairs of Carbon atoms that
have an inter-atomic distance below 2.0 Ångström.</p>
</li>
<li><p class="first">Try to find for each shape category (equant, prolate, oblate and bladed) some
molecules from <a class="reference external" href="http://pubchem.ncbi.nlm.nih.gov/">PubChem</a>. Just download a
bunch of SDF files and use the glob module from Python to loop over all these
files:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">glob</span> <span class="kn">import</span> <span class="n">glob</span>
<span class="k">for</span> <span class="n">fn</span> <span class="ow">in</span> <span class="n">glob</span><span class="p">(</span><span class="s">&quot;*.sdf&quot;</span><span class="p">):</span>
    <span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
    <span class="c"># do something here</span>
</pre></div>
</div>
<p>If you feel <cite>lucky</cite>, extend to program so that it downloads the first 100
molecules from the PubChem database.</p>
</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Working with molecules</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a><ul>
<li><a class="reference internal" href="#molecule-objects">Molecule objects</a></li>
<li><a class="reference internal" href="#derived-quantities">Derived quantities</a></li>
<li><a class="reference internal" href="#modifying-molecule-objects">Modifying molecule objects</a></li>
</ul>
</li>
<li><a class="reference internal" href="#examples">Examples</a><ul>
<li><a class="reference internal" href="#conversion-of-files">Conversion of files</a></li>
<li><a class="reference internal" href="#center-of-mass-to-origin">Center of mass to origin</a></li>
<li><a class="reference internal" href="#all-carbons">All carbons</a></li>
<li><a class="reference internal" href="#size-of-a-molecule">Size of a molecule</a></li>
<li><a class="reference internal" href="#shape-of-a-molecule">Shape of a molecule</a></li>
</ul>
</li>
<li><a class="reference internal" href="#problems">Problems</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="units.html"
                        title="previous chapter">Unit conversion</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="graph.html"
                        title="next chapter">Working with molecular graphs</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/tutorial/molecule.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="graph.html" title="Working with molecular graphs"
             >next</a> |</li>
        <li class="right" >
          <a href="units.html" title="Unit conversion"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">MolMod 1.1 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="examples.html" >MolMod by example</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2010, Toon Verstraelen.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>